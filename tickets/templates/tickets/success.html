{% extends "tickets/base.html" %}
{% block title %}Ticket Submitted{% endblock %}
{% block nav_submit %}active{% endblock %}

{% block content %}
<div class="ph">
  <h1>Ticket Submitted</h1>
  <p>Your work order has been received and routed to the appropriate team.</p>
</div>

<div class="card">
  <div class="sec">
    <div class="sec-title">Confirmation</div>
    <div style="display:flex;align-items:center;gap:16px;padding:8px 0 20px">
      <div style="font-family:'IBM Plex Mono',monospace;font-size:32px;color:var(--gold);font-weight:600">{{ ticket.ticket_id }}</div>
      <div>
        <div style="font-size:14px;color:var(--white);margin-bottom:4px">{{ ticket.title }}</div>
        <div style="font-size:12px;color:var(--steel-2)">Submitted {{ ticket.submitted_at|date:"N j, Y g:i A" }}</div>
      </div>
    </div>
  </div>

  <div class="sec">
    <div class="sec-title">Routing Decision</div>
    <div class="mrow"><span class="mk">Assigned Team</span><span class="mv" style="font-weight:600;color:var(--white)">{{ ticket.routing_team }}</span></div>
    <div class="mrow"><span class="mk">Dept Tier</span><span class="mv">{{ ticket.routing_tier_label }}</span></div>
    <div class="mrow"><span class="mk">Eff. Priority</span>
      <span class="mv">
        <span class="badge {{ ticket.priority_badge_class }}">{{ ticket.effective_priority_label }}</span>
        {% if ticket.routing_was_modified %}
          <span style="font-size:10px;color:var(--amber-2);margin-left:6px">(auto-adjusted from {{ ticket.user_priority_label }})</span>
        {% endif %}
      </span>
    </div>
    <div class="mrow"><span class="mk">SLA Target</span><span class="mv" style="color:var(--gold);font-family:'IBM Plex Mono',monospace">{{ ticket.routing_sla }}</span></div>
  </div>

  {% if ticket.routing_reasons_list %}
  <div class="sec" style="padding-bottom:20px">
    <div class="sec-title">Rules Applied</div>
    {% for reason in ticket.routing_reasons_list %}
      <div style="font-size:12px;color:var(--steel-2);margin-bottom:6px">&bull; {{ reason }}</div>
    {% endfor %}
  </div>
  {% endif %}
</div>

<div style="display:flex;gap:10px;padding:16px 0 0">
  <a href="{% url 'submit_ticket' %}" class="btn btn-primary">Submit Another Ticket</a>
  <a href="{% url 'admin_queue' %}" class="btn btn-ghost">View Admin Queue</a>
</div>
{% endblock %}
